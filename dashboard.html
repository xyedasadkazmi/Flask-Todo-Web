{% extends 'layout.html' %}
{% block title %}Dashboard - Flask ToDo{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>Dashboard</h3>
  <a href="{{ url_for('add_task') }}" class="btn btn-primary">Add Task</a>
</div>

<ul class="nav nav-tabs mb-3">
  <li class="nav-item">
    <a class="nav-link {% if filter=='active' %}active{% endif %}" href="{{ url_for('dashboard', filter='active') }}">Active Tasks</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {% if filter=='inactive' %}active{% endif %}" href="{{ url_for('dashboard', filter='inactive') }}">Inactive Tasks</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {% if filter=='all' %}active{% endif %}" href="{{ url_for('dashboard', filter='all') }}">All Tasks</a>
  </li>
</ul>

{% if tasks|length == 0 %}
  <div class="alert alert-info">No tasks to show.</div>
{% else %}
  <div class="table-wrapper">
  <table class="custom-dark-table table-hover align-middle">

      <thead>
        <tr>
          <th>Title</th>
          <th>Due</th>
          <th>Priority</th>
          <th>Category</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for t in tasks %}
        <tr>
          <td>{{ t.title }}</td>
          <td>{% if t.due_date %}{{ t.due_date.strftime('%Y-%m-%d %H:%M') }}{% else %}-{% endif %}</td>
          <td>{{ t.priority or '-' }}</td>
          <td>{{ t.category or '-' }}</td>
          <td>
            {% if t.is_completed %}
              <span class="badge bg-secondary">Inactive</span>
            {% else %}
              <span class="badge bg-success">Active</span>
            {% endif %}
          </td>
          <td>
            <a href="{{ url_for('edit_task', task_id=t.id) }}" class="btn btn-sm btn-outline-secondary">Edit</a>
            <form method="POST" action="{{ url_for('delete_task', task_id=t.id) }}" style="display:inline;" onsubmit="return confirm('Delete task?');">
              <button class="btn btn-sm btn-outline-danger">Delete</button>
            </form>
            <form method="POST" action="{{ url_for('toggle_task', task_id=t.id) }}" style="display:inline;">
              {% if t.is_completed %}
                <button class="btn btn-sm btn-outline-success">Mark Active</button>
              {% else %}
                <button class="btn btn-sm btn-outline-success">Mark Complete</button>
              {% endif %}
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endif %}

{% endblock %}
